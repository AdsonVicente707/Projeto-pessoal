<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meu Projeto Social</title>

  <!-- Fontes do Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome para √çcones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Cropper.js CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">

  <!-- Sua Folha de Estilo -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="admin-styles.css">
</head>

<body>

  <aside class="sidebar">
    <div style="display: flex; align-items: center; justify-content: space-between; padding-right: 15px;">
      <h1>Meu App</h1>
      <div style="position: relative; cursor: pointer;" id="notification-bell">
        <i class="fas fa-bell" style="font-size: 1.2rem; color: #333;"></i>
        <span class="notification-dot hidden" style="top: -2px; right: -2px;"></span>
      </div>
    </div>
    <nav>
      <ul>
        <li class="active"><i class="fas fa-home"></i> In√≠cio</li>
        <li><i class="fas fa-hashtag"></i> Explorar</li>
        <li><i class="fas fa-users"></i> Espa√ßos</li>
        <li><i class="fas fa-envelope-open-text"></i> Convites</li>
        <li id="menu-messages-btn" style="position: relative;"><i class="fas fa-envelope"></i> Mensagens <span
            id="msg-badge" class="notification-dot hidden" style="top: 15px; right: 15px;">0</span></li>
        <li><i class="fas fa-user"></i> Perfil</li>
        <li id="admin-menu-link" style="display: none;"><i class="fas fa-shield-alt"></i> Painel Admin</li>
        <li><i class="fas fa-cog"></i> Configura√ß√µes</li>
        <li id="logout-button"><i class="fas fa-sign-out-alt"></i> Sair</li>
      </ul>
    </nav>
  </aside>

  <main class="main-content">
    <div class="top-bar">
      <div class="user-profile-summary" id="top-profile-trigger">
        <span id="top-profile-name"></span>
        <img id="top-profile-avatar" class="avatar" src="" alt="Perfil">
      </div>
    </div>

    <section class="create-post">
      <h3>Criar nova publica√ß√£o</h3>
      <textarea id="post-text" placeholder="O que est√° acontecendo?"></textarea>
      <input type="file" id="image-upload" accept="image/*" style="display: none;">
      <div class="create-post-actions">
        <button id="add-photo-button"><i class="fas fa-camera"></i> Adicionar Foto</button>
        <button id="post-button">Postar</button>
      </div>
    </section>

    <!-- Stories Section -->
    <section class="stories-container" id="stories-section">
      <div class="stories-scroll" id="stories-scroll">
        <!-- Stories will be rendered here by JavaScript -->
      </div>
    </section>

    <section class="timeline" id="timeline-feed">
      <!-- Os posts ser√£o renderizados aqui pelo JavaScript -->
    </section>

    <!-- Se√ß√£o da P√°gina de Perfil (escondida por padr√£o) -->
    <section class="profile-page" id="profile-page">
      <div class="profile-banner-wrapper">
        <img id="profile-banner-display" src="" alt="Capa do Perfil" onerror="this.style.display='none'">
      </div>

      <div class="profile-header-section">
        <div class="profile-image-container">
          <div style="position: relative; display: inline-block;">
            <img src="" alt="Avatar do Perfil" class="avatar" id="profile-avatar">
            <div id="profile-avatar-edit-overlay"
              style="display: none; position: absolute; bottom: 0; right: 0; background: white; border-radius: 50%; padding: 5px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
              <i class="fas fa-camera" style="color: #333;"></i>
            </div>
          </div>
          <input type="file" id="profile-avatar-input" accept="image/*" style="display: none;">
        </div>

        <div class="profile-info-container">
          <h2 id="profile-name"></h2>
          <div class="profile-stats">
            <div class="stat-item"><span id="profile-connections-count">0</span> <strong>Conex√µes</strong></div>
            <div class="stat-item"><span id="profile-following-count">0</span> <strong>Seguindo</strong></div>
          </div>
          <p id="profile-bio" class="profile-bio"></p>
        </div>
      </div>

      <div class="profile-tabs">
        <button class="profile-tab-btn active" data-target="profile-posts-feed">Posts P√∫blicos</button>
        <button class="profile-tab-btn" id="family-memories-tab" data-target="family-memories-feed"
          style="display: none;"><i class="fas fa-lock"></i> Mem√≥rias de Fam√≠lia</button>
      </div>

      <div id="profile-created-spaces"></div>

      <h3 class="profile-posts-title" id="profile-posts-title"></h3>
      <div class="profile-posts-feed" id="profile-posts-feed">
        <!-- Posts do usu√°rio ser√£o inseridos aqui pelo JS -->
      </div>
      <div class="profile-posts-feed" id="family-memories-feed" style="display: none;">
        <!-- Mem√≥rias privadas aparecer√£o aqui -->
      </div>
    </section>

    <!-- Se√ß√£o da P√°gina Explorar (escondida por padr√£o) -->
    <section class="explore-page" id="explore-page">
      <div class="explore-header">
        <div class="explore-search-container">
          <i class="fas fa-search explore-search-icon"></i>
          <input type="text" id="explore-search-input" class="explore-search-input"
            placeholder="Buscar pessoas, posts...">
        </div>

        <div class="explore-tabs">
          <button class="explore-tab active" data-tab="all">
            <i class="fas fa-th"></i> Tudo
          </button>
          <button class="explore-tab" data-tab="people">
            <i class="fas fa-users"></i> Pessoas
          </button>
          <button class="explore-tab" data-tab="posts">
            <i class="fas fa-images"></i> Posts
          </button>
          <button class="explore-tab" data-tab="spaces">
            <i class="fas fa-home"></i> Espa√ßos
          </button>
        </div>

        <div class="explore-filters" id="explore-filters">
          <button class="filter-chip active" data-filter="all">
            <i class="fas fa-globe"></i> Todos
          </button>
          <button class="filter-chip" data-filter="family">
            <i class="fas fa-heart"></i> Fam√≠lia
          </button>
          <button class="filter-chip" data-filter="friends">
            <i class="fas fa-user-friends"></i> Amigos
          </button>
          <button class="filter-chip" data-filter="recent">
            <i class="fas fa-clock"></i> Recentes
          </button>
          <button class="filter-chip" data-filter="popular">
            <i class="fas fa-fire"></i> Populares
          </button>
        </div>
      </div>

      <!-- Suggested Users Section -->
      <div class="suggested-users-section" id="suggested-users-section">
        <div class="suggested-users-header">
          <h3>Sugest√µes para voc√™</h3>
          <button class="see-all-btn" id="see-all-suggestions">Ver tudo</button>
        </div>
        <div class="suggested-users-scroll" id="suggested-users-scroll">
          <!-- Suggested users will be rendered here -->
        </div>
      </div>

      <!-- Explore Grid -->
      <div class="explore-grid" id="explore-grid">
        <!-- Grid items will be rendered here -->
      </div>

      <!-- Loading State -->
      <div class="explore-loading" id="explore-loading" style="display: none;">
        <div class="loading-spinner">
          <div class="spinner-circle"></div>
        </div>
      </div>

      <!-- Empty State -->
      <div class="explore-empty" id="explore-empty" style="display: none;">
        <i class="fas fa-search"></i>
        <h3>Nenhum resultado encontrado</h3>
        <p>Tente ajustar seus filtros ou buscar por algo diferente</p>
      </div>
    </section>

    <!-- Se√ß√£o da P√°gina de Espa√ßos (escondida por padr√£o) -->
    <section class="spaces-page" id="spaces-page">
      <h2>Meus Espa√ßos</h2>
      <div class="spaces-list" id="spaces-list">
        <!-- Lista de espa√ßos ser√° renderizada aqui -->
      </div>
    </section>

    <!-- Se√ß√£o da P√°gina de Detalhes de um Espa√ßo (escondida por padr√£o) -->
    <section class="space-detail-page" id="space-detail-page">
      <div class="space-banner-container">
        <div id="space-banner" class="space-banner"></div>
        <button id="space-settings-btn" class="space-settings-btn" style="display: none;"
          title="Configura√ß√µes do Espa√ßo"><i class="fas fa-cog"></i></button>
      </div>

      <div class="space-header-content">
        <button id="back-to-spaces-button">&larr; Voltar</button>
        <h2 id="space-detail-name"></h2>
      </div>

      <div id="invite-member-container" style="display: none;">
        <h3>Convidar Membro</h3>
        <input type="email" id="invite-email-input" placeholder="Email do usu√°rio">
        <button id="send-invite-button">Enviar Convite</button>
      </div>
      <h3>Membros</h3>
      <div id="space-members-list"></div>

      <div class="space-tabs">
        <button class="tab-button active" data-tab="mural">Mural de Fotos</button>
        <button class="tab-button" data-tab="chat">Chat</button>
        <button class="tab-button" data-tab="timeline">Linha do Tempo</button>
        <button class="tab-button" data-tab="notes">Anota√ß√µes</button>
        <button class="tab-button" data-tab="audios">Mural de √Åudio</button>
      </div>
      <div class="tab-content" id="mural-content">
        <input type="file" id="photo-upload-input" accept="image/*" style="display: none;">
        <button id="add-space-photo-button">Adicionar Foto ao Mural</button>
        <div class="space-photo-grid" id="space-photo-grid"></div>
      </div>
      <div class="tab-content" id="chat-content" style="display: none;">
        <div class="chat-window" id="chat-window">
          <!-- Mensagens do chat ser√£o inseridas aqui -->
        </div>
        <div class="space-chat-input-area" id="space-chat-input-area">
          <button class="space-chat-actions-btn" id="space-chat-image-btn" title="Enviar Imagem"><i
              class="fas fa-image"></i></button>
          <input type="file" id="space-chat-image-input" accept="image/*" style="display: none;">
          <input type="text" id="space-chat-message-input" placeholder="Digite sua mensagem..." autocomplete="off">
          <button class="space-chat-send-btn" id="space-chat-send-btn"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>
      <div class="tab-content" id="timeline-content" style="display: none;">
        <div class="create-post space-create-post">
          <textarea id="space-post-text" placeholder="Compartilhe um momento..."></textarea>
          <input type="file" id="space-post-image-upload" accept="image/*" style="display: none;">
          <div class="create-post-actions">
            <button id="add-space-post-photo-button"><i class="fas fa-camera"></i> Adicionar Foto</button>
            <button id="create-space-post-button">Postar no Espa√ßo</button>
          </div>
        </div>
        <div class="space-timeline-feed" id="space-timeline-feed"></div>
      </div>
      <div class="tab-content" id="notes-content" style="display: none;">
        <div class="create-note-container">
          <textarea id="note-text-input" placeholder="Escreva uma nova anota√ß√£o..."></textarea>
          <button id="create-note-button">Salvar Anota√ß√£o</button>
        </div>
        <div class="notes-list" id="notes-list"></div>
      </div>
      <div class="tab-content" id="audios-content" style="display: none;">
        <div class="audio-recorder-container">
          <button id="record-audio-button">Gravar √Åudio</button>
          <p id="recording-status"></p>
        </div>
        <div class="audio-list" id="audio-list"></div>
      </div>
    </section>

    <!-- Se√ß√£o da P√°gina de Convites (escondida por padr√£o) -->
    <section class="invitations-page" id="invitations-page">
      <h2>Meus Convites Pendentes</h2>

      <h3>Convites para Espa√ßos</h3>
      <div id="space-invitations-list">
        <!-- Convites de espa√ßos ser√£o renderizados aqui -->
      </div>

      <h3 style="margin-top: 30px;">Pedidos de Conex√£o</h3>
      <div id="connection-requests-list"></div>
    </section>

    <!-- Se√ß√£o da P√°gina de Configura√ß√µes (escondida por padr√£o) -->
    <section class="settings-page" id="settings-page" style="display: none;">
      <h2>Configura√ß√µes</h2>
      <div class="settings-container">
        <div class="settings-sidebar">
          <button class="settings-tab active" data-target="settings-profile">Perfil & Apar√™ncia</button>
          <button class="settings-tab" data-target="settings-account" disabled>Conta (Em breve)</button>
        </div>
        <div class="settings-content">
          <!-- Aba Perfil -->
          <div id="settings-profile" class="settings-panel active">
            <h3>Personalizar Experi√™ncia</h3>

            <div class="setting-item">
              <label>Apar√™ncia</label>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span>Modo Escuro</span>
                <label class="switch">
                  <input type="checkbox" id="dark-mode-toggle">
                  <span class="slider round"></span>
                </label>
              </div>
            </div>

            <div class="setting-item">
              <label>Banner do Perfil</label>
              <p class="setting-desc">Essa imagem aparecer√° no topo do seu perfil p√∫blico.</p>
              <input type="file" id="settings-banner-input" accept="image/*">
              <button id="save-banner-btn" class="btn-primary">Atualizar Banner</button>
            </div>

            <div class="setting-item">
              <label>Fundo do Chat</label>
              <p class="setting-desc">Escolha uma imagem para o fundo das suas conversas (vis√≠vel apenas para voc√™).</p>
              <input type="file" id="settings-chatbg-input" accept="image/*">
            </div>
    </section>

    <!-- Se√ß√£o do Painel Administrativo (escondida por padr√£o, apenas para admins) -->
    <section class="admin-panel-page" id="admin-panel-page" style="display: none;">
      <div class="admin-header">
        <h2><i class="fas fa-shield-alt"></i> Painel Administrativo</h2>
        <p>Gerenciamento completo do sistema</p>
      </div>

      <div class="admin-tabs">
        <button class="admin-tab active" data-tab="dashboard">
          <i class="fas fa-chart-line"></i> Dashboard
        </button>
        <button class="admin-tab" data-tab="users">
          <i class="fas fa-users"></i> Usu√°rios
        </button>
        <button class="admin-tab" data-tab="themes">
          <i class="fas fa-palette"></i> Temas Sazonais
        </button>
      </div>

      <!-- Dashboard Tab -->
      <div class="admin-tab-content active" id="admin-dashboard-tab">
        <div class="admin-stats-grid" id="admin-stats-grid">
          <!-- Stats will be loaded here -->
        </div>
      </div>

      <!-- Users Tab -->
      <div class="admin-tab-content" id="admin-users-tab" style="display: none;">
        <!-- Toolbar -->
        <div class="users-toolbar"
          style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; align-items: center;">
          <div class="search-container" style="flex: 1; min-width: 250px; position: relative;">
            <i class="fas fa-search"
              style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
            <input type="text" id="users-search" placeholder="Buscar por nome ou email..."
              style="width: 100%; padding: 10px 10px 10px 36px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
          </div>

          <select id="filter-role" class="filter-select"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-main); cursor: pointer;">
            <option value="">Todos os Roles</option>
            <option value="admin">üëë Admins</option>
            <option value="user">üë§ Usu√°rios</option>
          </select>

          <select id="filter-status" class="filter-select"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-main); cursor: pointer;">
            <option value="">Todos os Status</option>
            <option value="active">‚úÖ Ativos</option>
            <option value="suspended">üö´ Suspensos</option>
          </select>

          <select id="sort-by" class="filter-select"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg); color: var(--text-main); cursor: pointer;">
            <option value="recent">üïê Mais Recentes</option>
            <option value="name">üî§ Nome (A-Z)</option>
            <option value="oldest">üìÖ Mais Antigos</option>
          </select>
        </div>

        <div class="admin-users-list" id="admin-users-list">
          <!-- Users will be loaded here -->
        </div>

        <!-- Pagination -->
        <div class="pagination" id="users-pagination"
          style="display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: 20px;">
          <!-- Pagination controls will be loaded here -->
        </div>
      </div>

      <!-- Themes Tab -->
      <div class="admin-tab-content" id="admin-themes-tab" style="display: none;">
        <button class="admin-create-theme-btn" id="admin-create-theme-btn">
          <i class="fas fa-plus"></i> Criar Novo Tema
        </button>
        <div class="admin-themes-list" id="admin-themes-list">
          <!-- Themes will be loaded here -->
        </div>
      </div>
    </section>

    <!-- Modal de Cria√ß√£o de Tema (Admin Panel) -->
    <div id="admin-theme-modal"
      style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; align-items: center; justify-content: center;">
      <div
        style="background: var(--bg-surface); padding: 32px; border-radius: 12px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
        <h2>Criar Tema Sazonal</h2>
        <form id="admin-theme-form">
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Nome do Tema</label>
            <input type="text" id="admin-theme-name" required placeholder="Ex: Natal 2026"
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Slug (identificador √∫nico)</label>
            <input type="text" id="admin-theme-slug" required placeholder="Ex: christmas"
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Cor Prim√°ria</label>
            <input type="color" id="admin-theme-primary" value="#C41E3A"
              style="width: 100%; height: 50px; border: 1px solid var(--input-border); border-radius: 8px; cursor: pointer;">
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Cor Secund√°ria</label>
            <input type="color" id="admin-theme-secondary" value="#165B33"
              style="width: 100%; height: 50px; border: 1px solid var(--input-border); border-radius: 8px; cursor: pointer;">
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Tipo de Part√≠culas</label>
            <select id="admin-theme-particles"
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
              <option value="none">Nenhuma</option>
              <option value="snow">Neve</option>
              <option value="confetti">Confete</option>
              <option value="hearts">Cora√ß√µes</option>
              <option value="flowers">Flores</option>
              <option value="bats">Morcegos</option>
            </select>
          </div>
          <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button type="submit"
              style="flex: 1; padding: 12px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">Criar
              Tema</button>
            <button type="button" id="admin-cancel-theme-btn"
              style="flex: 1; padding: 12px; background: var(--bg-hover); color: var(--text-main); border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">Cancelar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- User Details Modal -->
    <div class="modal" id="user-details-modal"
      style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; align-items: center; justify-content: center;">
      <div class="modal-content modal-large"
        style="background: var(--bg-surface); padding: 32px; border-radius: 12px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
        <button class="modal-close" onclick="closeUserDetailsModal()"
          style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.6); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">
          <i class="fas fa-times"></i>
        </button>

        <div class="user-details-header">
          <div class="user-banner" id="detail-banner"
            style="background: linear-gradient(135deg, var(--primary), var(--secondary)); height: 120px; border-radius: 8px; margin-bottom: -50px;">
          </div>
          <div class="user-avatar-container" style="text-align: center; margin-bottom: 20px;">
            <img id="detail-avatar" class="user-avatar-large" src="" alt=""
              style="width: 100px; height: 100px; border-radius: 50%; border: 4px solid var(--bg-surface); margin-top: 50px;">
          </div>
        </div>

        <div class="user-details-body" style="text-align: center;">
          <h2 id="detail-name" style="margin: 10px 0;"></h2>
          <p class="user-email" id="detail-email" style="color: var(--text-secondary); margin: 5px 0;"></p>
          <div style="display: flex; gap: 8px; justify-content: center; margin: 15px 0;">
            <span class="user-badge" id="detail-role-badge"></span>
            <span class="user-status-badge" id="detail-status-badge"></span>
          </div>

          <p class="user-bio" id="detail-bio" style="color: var(--text-secondary); margin: 20px 0;"></p>

          <div class="user-stats"
            style="display: flex; gap: 32px; justify-content: center; margin: 24px 0; padding: 20px; background: var(--bg-hover); border-radius: 12px;">
            <div class="stat-item" style="text-align: center;">
              <div class="stat-number" id="detail-posts"
                style="font-size: 24px; font-weight: 700; color: var(--primary);">0</div>
              <div class="stat-label" style="font-size: 12px; color: var(--text-secondary);">Posts</div>
            </div>
            <div class="stat-item" style="text-align: center;">
              <div class="stat-number" id="detail-connections"
                style="font-size: 24px; font-weight: 700; color: var(--primary);">0</div>
              <div class="stat-label" style="font-size: 12px; color: var(--text-secondary);">Conex√µes</div>
            </div>
            <div class="stat-item" style="text-align: center;">
              <div class="stat-number" id="detail-messages"
                style="font-size: 24px; font-weight: 700; color: var(--primary);">0</div>
              <div class="stat-label" style="font-size: 12px; color: var(--text-secondary);">Mensagens</div>
            </div>
          </div>

          <div class="user-actions" style="display: flex; gap: 12px; flex-wrap: wrap; justify-content: center;">
            <button class="btn btn-primary" onclick="openEditUserModal()"
              style="display: flex; align-items: center; gap: 6px;">
              <i class="fas fa-edit"></i> Editar Perfil
            </button>
            <button class="btn btn-secondary" onclick="openChatWithUser()"
              style="display: flex; align-items: center; gap: 6px;">
              <i class="fas fa-comment"></i> Enviar Mensagem
            </button>
            <button class="btn btn-danger" onclick="confirmDeleteUser()"
              style="display: flex; align-items: center; gap: 6px;">
              <i class="fas fa-trash"></i> Excluir Usu√°rio
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- User Edit Modal -->
    <div class="modal" id="user-edit-modal"
      style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; align-items: center; justify-content: center;">
      <div class="modal-content"
        style="background: var(--bg-surface); padding: 32px; border-radius: 12px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
        <button class="modal-close" onclick="closeEditUserModal()"
          style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.6); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">
          <i class="fas fa-times"></i>
        </button>

        <h2>Editar Usu√°rio</h2>

        <form id="user-edit-form">
          <input type="hidden" id="edit-user-id">

          <div class="form-group" style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Nome</label>
            <input type="text" id="edit-name" required
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
          </div>

          <div class="form-group" style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Email</label>
            <input type="email" id="edit-email" required
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
          </div>

          <div class="form-group" style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Bio</label>
            <textarea id="edit-bio" rows="3"
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);"></textarea>
          </div>

          <div class="form-group" style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Role</label>
            <select id="edit-role"
              style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
              <option value="user">Usu√°rio</option>
              <option value="admin">Admin</option>
            </select>
          </div>

          <div class="form-group" style="margin-bottom: 20px;">
            <label class="checkbox-label" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" id="edit-suspended">
              Conta Suspensa
            </label>
          </div>

          <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar Altera√ß√µes</button>
            <button type="button" class="btn btn-secondary" onclick="closeEditUserModal()"
              style="flex: 1;">Cancelar</button>
          </div>
        </form>
      </div>
    </div>

  </main>

  <!-- Modal de Recorte de Imagem -->
  <div id="crop-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; flex-direction: column;">
    <div
      style="background: white; padding: 20px; border-radius: 8px; max-width: 90%; max-height: 90%; display: flex; flex-direction: column; align-items: center;">
      <h3 style="margin-bottom: 15px;">Ajuste sua foto</h3>
      <div style="max-width: 500px; max-height: 400px; overflow: hidden; background: #f0f0f0;">
        <img id="crop-image" style="max-width: 100%; display: block;">
      </div>
      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button id="crop-cancel-btn"
          style="padding: 8px 16px; background: #ccc; border: none; border-radius: 4px; cursor: pointer;">Cancelar</button>
        <button id="crop-save-btn"
          style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Salvar
          Corte</button>
      </div>
    </div>
  </div>

  <!-- Modal de Ajuste de Posi√ß√£o -->
  <div id="position-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; flex-direction: column;">
    <div
      style="background: white; padding: 20px; border-radius: 8px; width: 300px; display: flex; flex-direction: column; align-items: center;">
      <h3 style="margin-bottom: 15px;">Ajustar Posi√ß√£o</h3>
      <div
        style="width: 150px; height: 150px; border-radius: 50%; overflow: hidden; margin-bottom: 20px; border: 2px solid #ddd;">
        <img id="position-preview-image" style="width: 100%; height: 100%; object-fit: cover;">
      </div>
      <div style="width: 100%; margin-bottom: 10px;">
        <label>Horizontal (X)</label>
        <input type="range" id="pos-x" min="0" max="100" value="50" style="width: 100%;">
      </div>
      <div style="width: 100%; margin-bottom: 20px;">
        <label>Vertical (Y)</label>
        <input type="range" id="pos-y" min="0" max="100" value="50" style="width: 100%;">
      </div>
      <div style="display: flex; gap: 10px;">
        <button id="pos-cancel-btn"
          style="padding: 8px 16px; background: #ccc; border: none; border-radius: 4px; cursor: pointer;">Cancelar</button>
        <button id="pos-save-btn"
          style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal de Seguindo -->
  <div id="connections-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center;">
    <div
      style="background: white; padding: 20px; border-radius: 8px; width: 90%; max-width: 400px; max-height: 80%; display: flex; flex-direction: column; position: relative;">
      <span id="close-connections-modal"
        style="position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer;">&times;</span>
      <h3 style="margin-top: 0; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">Seguindo</h3>
      <div id="connections-list" style="overflow-y: auto; flex-grow: 1;">
        <!-- Lista de usu√°rios ser√° inserida aqui -->
      </div>
    </div>
  </div>

  <!-- Modal de Mensagens (Estilo Direct) -->
  <div id="messages-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
    <div class="messages-modal-content">
      <div class="messages-sidebar">
        <div class="messages-header">
          <h3>Mensagens</h3>
          <i class="fas fa-edit" id="new-msg-btn" title="Nova Conversa"
            style="cursor: pointer; color: #3B82F6; font-size: 1.2rem;"></i>
        </div>
        <div class="msg-search-bar" style="padding: 10px 20px; border-bottom: 1px solid #dbdbdb;">
          <input type="text" id="msg-search-input" placeholder="Buscar pessoas ou conversas..."
            style="width: 100%; padding: 8px; border: 1px solid #dbdbdb; border-radius: 6px;">
        </div>
        <div id="conversations-list-container" class="conversations-list">
          <!-- Lista de conversas -->
        </div>
      </div>
      <div class="messages-chat-area" id="msg-chat-area">
        <div class="chat-header">
          <img src="" id="msg-header-avatar" class="avatar" style="display:none"> <!-- Escondido at√© selecionar -->
          <strong id="msg-header-name">Selecione uma conversa</strong>
          <span id="close-messages-modal" style="cursor: pointer; margin-left: auto; font-size: 1.5rem;">&times;</span>
        </div>
        <div id="msg-feed" class="chat-feed"></div>
        <div id="typing-indicator"
          style="display: none; padding: 5px 20px; color: #888; font-size: 0.8em; font-style: italic;">Digitando...
        </div>
        <div id="msg-preview-container" style="display: none;">
          <img id="msg-preview-img" src="">
          <button id="msg-preview-close" type="button">&times;</button>
        </div>
        <div class="msg-input-area" style="display: none;">
          <i class="fas fa-image" id="msg-image-btn" title="Enviar Imagem"
            style="font-size: 1.5rem; color: #3B82F6; cursor: pointer;"></i>
          <input type="file" id="msg-image-input" accept="image/*" style="display: none;">
          <input type="text" id="msg-input" placeholder="Escreva uma mensagem...">
          <button id="msg-send-btn" type="button"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup de Nova Mensagem -->
  <div id="message-popup" class="message-popup" style="display: none;">
    <div class="popup-content">
      <img id="popup-avatar" src="" alt="Avatar" class="popup-avatar">
      <div class="popup-text-info">
        <div class="popup-header">
          <strong id="popup-sender-name">Nova Mensagem</strong>
          <span id="popup-close">&times;</span>
        </div>
        <div class="popup-body" id="popup-message-preview"></div>
      </div>
    </div>
    <div class="popup-progress"></div>
  </div>

  <!-- Modal de Configura√ß√µes do Espa√ßo -->
  <div id="space-settings-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
    <div
      style="background: var(--bg-surface); padding: 25px; border-radius: 12px; width: 90%; max-width: 400px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
      <h3 style="margin-top: 0; color: var(--text-main);">Personalizar Espa√ßo</h3>

      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Nome do Espa√ßo</label>
        <input type="text" id="edit-space-name"
          style="width: 100%; padding: 10px; border: 1px solid var(--input-border); border-radius: 6px; background: var(--input-bg); color: var(--text-main);">
      </div>

      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Fundo do Espa√ßo</label>
        <p style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 10px;">Escolha uma cor ou envie uma
          imagem.</p>
        <input type="color" id="edit-space-color" value="#3B82F6"
          style="width: 100%; height: 40px; cursor: pointer; border: none; padding: 0;">
        <div style="margin-top: 10px; text-align: center;">ou</div>
        <input type="file" id="edit-space-image" accept="image/*" style="margin-top: 10px; width: 100%;">
      </div>

      <div style="display: flex; justify-content: flex-end; gap: 10px;">
        <button id="cancel-space-settings"
          style="padding: 8px 16px; background: transparent; border: 1px solid var(--border-color); color: var(--text-main); border-radius: 6px; cursor: pointer;">Cancelar</button>
        <button id="save-space-settings"
          style="padding: 8px 16px; background: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer;">Salvar
          Altera√ß√µes</button>
      </div>
    </div>
  </div>

  <!-- Modal de Confirma√ß√£o de Exclus√£o de Espa√ßo -->
  <div id="delete-space-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; justify-content: center; align-items: center; flex-direction: column;">
    <div class="delete-modal-content">
      <div class="delete-icon-animation">
        <i class="fas fa-trash-alt"></i>
      </div>
      <h3>Realmente deseja apagar essas mem√≥rias?</h3>
      <p style="color: var(--text-secondary); margin-bottom: 20px;">Esta a√ß√£o √© irrevers√≠vel. Todas as fotos, mensagens
        e √°udios deste espa√ßo ser√£o perdidos para sempre.</p>

      <label class="delete-confirmation-checkbox">
        <input type="checkbox" id="confirm-delete-checkbox">
        Estou ciente e quero excluir este espa√ßo.
      </label>

      <div class="delete-modal-actions">
        <button id="cancel-delete-btn">Cancelar</button>
        <button id="confirm-delete-btn" disabled>Apagar Espa√ßo</button>
      </div>
    </div>
  </div>

  <!-- Modal de Cria√ß√£o de Espa√ßo (Novo Design) -->
  <div id="create-space-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;">
    <div
      style="background: var(--bg-surface); padding: 30px; border-radius: 16px; width: 90%; max-width: 450px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); animation: popIn 0.3s ease-out;">
      <h3 style="margin-top: 0; color: var(--text-main); text-align: center; margin-bottom: 20px;">Novo Espa√ßo</h3>

      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-main);">Nome do
          Espa√ßo</label>
        <input type="text" id="new-space-name" placeholder="Ex: Fam√≠lia Silva"
          style="width: 100%; padding: 12px; border: 1px solid var(--input-border); border-radius: 8px; background: var(--input-bg); color: var(--text-main); font-size: 1rem;">
      </div>

      <div style="margin-bottom: 25px;">
        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-main);">Cor de
          Capa</label>
        <div style="display: flex; gap: 10px; align-items: center;">
          <input type="color" id="new-space-color" value="#3B82F6"
            style="width: 60px; height: 40px; cursor: pointer; border: none; padding: 0; border-radius: 6px;">
          <span style="color: var(--text-secondary); font-size: 0.9em;">Escolha uma cor para identificar o
            espa√ßo.</span>
        </div>
      </div>

      <div style="display: flex; justify-content: flex-end; gap: 10px;">
        <button id="cancel-create-space"
          style="padding: 10px 20px; background: transparent; border: 1px solid var(--border-color); color: var(--text-main); border-radius: 8px; cursor: pointer; font-weight: 600;">Cancelar</button>
        <button id="confirm-create-space"
          style="padding: 10px 20px; background: #3B82F6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; box-shadow: 0 2px 5px rgba(59, 130, 246, 0.3);">Criar
          Espa√ßo</button>
      </div>
    </div>
  </div>

  <!-- Lightbox para Mural de Fotos -->
  <div id="lightbox-modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 3000; justify-content: center; align-items: center;">
    <span id="lightbox-close"
      style="position: absolute; top: 20px; right: 30px; color: white; font-size: 2rem; cursor: pointer;">&times;</span>
    <img id="lightbox-img" src=""
      style="max-width: 90%; max-height: 90%; border-radius: 4px; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script src="components.js"></script>
  <script src="admin-tabs.js"></script>
  <script src="admin-users.js"></script>
  <script type="module" src="script.js"></script>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
</body>

</html>